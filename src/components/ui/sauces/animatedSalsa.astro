---
// AnimatedSalsa.astro
---

<div
  class="fade-in-section opacity-0 transition-all duration-700 ease-out"
  data-direction={Astro.props.direction}>
  <slot />
</div>

<script>
  const fadeElements = document.querySelectorAll(".fade-in-section");

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const element = entry.target;
          const direction = element.getAttribute("data-direction");

          // Aplicamos la posición inicial según la dirección
          if (direction === "left") {
            element.classList.add("-translate-x-full");
          } else {
            element.classList.add("translate-x-full");
          }

          // Forzamos un reflow
          void (element as HTMLElement).offsetWidth;

          // Animamos a la posición final
          element.classList.add("opacity-100");
          element.classList.remove("-translate-x-full", "translate-x-full");

          observer.unobserve(element);
        }
      });
    },
    {
      threshold: 0.1,
    }
  );

  fadeElements.forEach((element) => {
    const direction = element.getAttribute("data-direction");
    if (direction === "left") {
      element.classList.add("-translate-x-full");
    } else {
      element.classList.add("translate-x-full");
    }
    observer.observe(element);
  });
</script>

<style>
  .fade-in-section {
    transform: translateX(0);
    will-change: transform, opacity;
  }
</style>
